g.V().hasLabel("PERSON").has("id", $personId).as('person').both("KNOWS").in("HASCREATOR").hasLabel("POST").as('post').has("creationDate", gte($startDate).and(lt($endDate))).out("HASTAG").as('tag').select("person").not(both("KNOWS").in("HASCREATOR").hasLabel("POST").has("creationDate", lt($startDate)).out("HASTAG").where(eq('tag'))).select("tag").groupCount().order().by(select("values"), Order.desc).by(select("keys").by('name'), Order.asc).limit(10).as("ordered").select("keys").by("name").as("tagName").select("ordered").select("values").as("postCount").select("tagName","postCount")