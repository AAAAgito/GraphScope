g.V().hasLabel('PERSON').has('id',$personId).both('KNOWS').as('friend').in('HASCREATOR').hasLabel('COMMENT').where(out('REPLYOF').hasLabel('POST').out('HASTAG').out('HASTYPE').has('name',eq('$tagClassName'))).select('friend').groupCount().order().by(select('values'), desc).by(select('keys').by('id'), asc).limit(20)